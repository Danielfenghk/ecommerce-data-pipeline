{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2025-12-31T03:56:56.078601Z", "invocation_id": "8440bea9-2a6f-492c-af00-b43b1d412bc9", "invocation_started_at": "2025-12-31T03:56:54.897286Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.793179Z", "completed_at": "2025-12-31T03:56:55.864235Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.864639Z", "completed_at": "2025-12-31T03:56:55.864653Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07489633560180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.stg_orders", "compiled": true, "compiled_code": "-- stg_orders.sql\n-- Staging model: Clean and standardize order data\n\n\n\nwith source as (\n    select * from \"ecommerce_warehouse\".\"public\".\"orders\"\n),\n\ncleaned as (\n    select\n        -- Primary key\n        order_id,\n        \n        -- Foreign keys\n        customer_id,\n        \n        -- Order details\n        order_date::timestamp as order_date,\n        to_char(order_date::date, 'YYYYMMDD')::integer as date_key,\n        \n        -- Status (standardized)\n        lower(trim(status)) as order_status,\n        lower(trim(payment_method)) as payment_method,\n        \n        -- Amounts\n        coalesce(subtotal, 0) as subtotal,\n        coalesce(tax, 0) as tax_amount,\n        coalesce(shipping_cost, 0) as shipping_amount,\n        coalesce(total_amount, 0) as total_amount,\n        \n        -- Order value tier\n        case\n            when total_amount < 50 then 'Very Low'\n            when total_amount < 100 then 'Low'\n            when total_amount < 200 then 'Medium'\n            when total_amount < 500 then 'High'\n            else 'Very High'\n        end as order_value_tier,\n        \n        -- Flags\n        status = 'completed' as is_completed,\n        status in ('shipped', 'completed') as is_fulfilled,\n        \n        -- Metadata\n        created_at,\n        current_timestamp as _loaded_at\n        \n    from source\n    where order_id is not null\n      and total_amount >= 0  -- Filter out invalid orders\n)\n\nselect * from cleaned", "relation_name": "\"ecommerce_warehouse\".\"public_staging\".\"stg_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.861364Z", "completed_at": "2025-12-31T03:56:55.866438Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.875110Z", "completed_at": "2025-12-31T03:56:55.875124Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08389782905578613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.stg_products", "compiled": true, "compiled_code": "-- stg_products.sql\n-- Staging model: Clean and standardize product data\n\n\n\nwith source as (\n    select * from \"ecommerce_warehouse\".\"public\".\"products\"\n),\n\ncleaned as (\n    select\n        -- Primary key\n        product_id,\n        \n        -- Product info\n        trim(name) as product_name,\n        trim(category) as category,\n        trim(subcategory) as subcategory,\n        trim(brand) as brand,\n        \n        -- Pricing\n        coalesce(price, 0) as price,\n        coalesce(cost, 0) as cost,\n        \n        -- Calculated fields\n        case \n            when price > 0 then round(((price - cost) / price * 100)::numeric, 2)\n            else 0 \n        end as profit_margin_pct,\n        \n        -- Price tier classification\n        case\n            when price < 20 then 'Budget'\n            when price < 50 then 'Standard'\n            when price < 100 then 'Premium'\n            else 'Luxury'\n        end as price_tier,\n        \n        -- Inventory\n        coalesce(stock_quantity, 0) as stock_quantity,\n        stock_quantity > 0 as is_in_stock,\n        \n        -- Metadata\n        created_at,\n        current_timestamp as _loaded_at\n        \n    from source\n    where product_id is not null\n)\n\nselect * from cleaned", "relation_name": "\"ecommerce_warehouse\".\"public_staging\".\"stg_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.850877Z", "completed_at": "2025-12-31T03:56:55.866757Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.875808Z", "completed_at": "2025-12-31T03:56:55.875816Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08504438400268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_accepted_values_raw_customers_customer_segment__Premium__Regular__New__VIP.b924736c1b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"ecommerce_warehouse\".\"public\".\"customers\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Premium','Regular','New','VIP'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.848374Z", "completed_at": "2025-12-31T03:56:55.874496Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.876620Z", "completed_at": "2025-12-31T03:56:55.876626Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0862877368927002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.stg_customers", "compiled": true, "compiled_code": "-- stg_customers.sql\n-- Staging model: Clean and standardize customer data\n\n\n\nwith source as (\n    select * from \"ecommerce_warehouse\".\"public\".\"customers\"\n),\n\ncleaned as (\n    select\n        -- Primary key\n        customer_id,\n        \n        -- Names (cleaned)\n        trim(first_name) as first_name,\n        trim(last_name) as last_name,\n        trim(first_name) || ' ' || trim(last_name) as full_name,\n        \n        -- Contact info\n        lower(trim(email)) as email,\n        phone,\n        \n        -- Location\n        trim(city) as city,\n        trim(state) as state,\n        trim(country) as country,\n        trim(postal_code) as postal_code,\n        \n        -- Segmentation\n        coalesce(customer_segment, 'Unknown') as customer_segment,\n        \n        -- Dates\n        registration_date::date as registration_date,\n        \n        -- Calculated fields\n        current_date - registration_date::date as customer_tenure_days,\n        \n        -- Metadata\n        created_at,\n        current_timestamp as _loaded_at\n        \n    from source\n    where customer_id is not null\n)\n\nselect * from cleaned", "relation_name": "\"ecommerce_warehouse\".\"public_staging\".\"stg_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.867156Z", "completed_at": "2025-12-31T03:56:55.878027Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.879527Z", "completed_at": "2025-12-31T03:56:55.879534Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014059305191040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_raw_customers_customer_id.e869432dbb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ecommerce_warehouse\".\"public\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.881678Z", "completed_at": "2025-12-31T03:56:55.897621Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.898730Z", "completed_at": "2025-12-31T03:56:55.898737Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020038843154907227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_raw_orders_order_id.03a065a98f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"ecommerce_warehouse\".\"public\".\"orders\"\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.889962Z", "completed_at": "2025-12-31T03:56:55.898020Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.899346Z", "completed_at": "2025-12-31T03:56:55.899350Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019318342208862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_raw_products_price.ce9a7bfd3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom \"ecommerce_warehouse\".\"public\".\"products\"\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.884945Z", "completed_at": "2025-12-31T03:56:55.898374Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.900159Z", "completed_at": "2025-12-31T03:56:55.900166Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021087169647216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_raw_orders_total_amount.36d4c28fec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom \"ecommerce_warehouse\".\"public\".\"orders\"\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.894180Z", "completed_at": "2025-12-31T03:56:55.899843Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.901901Z", "completed_at": "2025-12-31T03:56:55.901969Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01278996467590332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_not_null_raw_products_product_id.b984a33cae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"ecommerce_warehouse\".\"public\".\"products\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.907664Z", "completed_at": "2025-12-31T03:56:55.923493Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.923845Z", "completed_at": "2025-12-31T03:56:55.923853Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020254135131835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_raw_customers_customer_id.3579d23017", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.912539Z", "completed_at": "2025-12-31T03:56:55.924345Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.925201Z", "completed_at": "2025-12-31T03:56:55.925207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02078533172607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_raw_customers_email.0bd2938698", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public\".\"customers\"\nwhere email is not null\ngroup by email\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.918875Z", "completed_at": "2025-12-31T03:56:55.925758Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.927324Z", "completed_at": "2025-12-31T03:56:55.927331Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020464420318603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_raw_products_product_id.518dac90ba", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public\".\"products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.915506Z", "completed_at": "2025-12-31T03:56:55.926488Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.928236Z", "completed_at": "2025-12-31T03:56:55.928243Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0225985050201416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.source_unique_raw_orders_order_id.2e0765462f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public\".\"orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.933549Z", "completed_at": "2025-12-31T03:56:55.953754Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.954901Z", "completed_at": "2025-12-31T03:56:55.954912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026248931884765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.dim_products", "compiled": true, "compiled_code": "-- dim_products.sql\n-- Mart model: Product dimension\n\n\n\nwith products as (\n    select * from \"ecommerce_warehouse\".\"public_staging\".\"stg_products\"\n),\n\nfinal as (\n    select\n        -- Surrogate key\n        md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,\n        \n        -- Natural key\n        product_id,\n        \n        -- Product attributes\n        product_name,\n        category,\n        subcategory,\n        brand,\n        \n        -- Pricing\n        price as current_price,\n        cost,\n        profit_margin_pct,\n        price_tier,\n        \n        -- Inventory\n        stock_quantity,\n        is_in_stock,\n        \n        -- Inventory status\n        case\n            when stock_quantity = 0 then 'Out of Stock'\n            when stock_quantity < 10 then 'Low Stock'\n            when stock_quantity < 50 then 'Medium Stock'\n            else 'Well Stocked'\n        end as inventory_status,\n        \n        -- SCD fields\n        true as is_current,\n        current_date as effective_date,\n        \n        -- Metadata\n        current_timestamp as _created_at,\n        current_timestamp as _updated_at\n        \n    from products\n)\n\nselect * from final", "relation_name": "\"ecommerce_warehouse\".\"public_marts\".\"dim_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.949621Z", "completed_at": "2025-12-31T03:56:55.956146Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.957405Z", "completed_at": "2025-12-31T03:56:55.957412Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024248361587524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.946848Z", "completed_at": "2025-12-31T03:56:55.956504Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.957988Z", "completed_at": "2025-12-31T03:56:55.957994Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025238037109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ecommerce_warehouse\".\"public_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.958552Z", "completed_at": "2025-12-31T03:56:55.980022Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.987305Z", "completed_at": "2025-12-31T03:56:55.987327Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03194594383239746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.dim_customers", "compiled": true, "compiled_code": "-- dim_customers.sql\n-- Mart model: Customer dimension with all attributes\n\n\n\nwith  __dbt__cte__int_customer_orders as (\n-- int_customer_orders.sql\n-- Intermediate model: Customer order aggregations\n\n\n\nwith orders as (\n    select * from \"ecommerce_warehouse\".\"public_staging\".\"stg_orders\"\n),\n\ncustomer_orders as (\n    select\n        customer_id,\n        \n        -- Order counts\n        count(*) as total_orders,\n        count(case when is_completed then 1 end) as completed_orders,\n        \n        -- Revenue metrics\n        sum(total_amount) as total_revenue,\n        avg(total_amount) as avg_order_value,\n        max(total_amount) as max_order_value,\n        min(total_amount) as min_order_value,\n        \n        -- Time metrics\n        min(order_date) as first_order_date,\n        max(order_date) as last_order_date,\n        \n        -- Recency\n        current_date - max(order_date)::date as days_since_last_order\n        \n    from orders\n    group by customer_id\n)\n\nselect * from customer_orders\n), customers as (\n    select * from \"ecommerce_warehouse\".\"public_staging\".\"stg_customers\"\n),\n\ncustomer_orders as (\n    select * from __dbt__cte__int_customer_orders\n),\n\nfinal as (\n    select\n        -- Surrogate key\n        md5(cast(coalesce(cast(c.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,\n        \n        -- Natural key\n        c.customer_id,\n        \n        -- Customer attributes\n        c.first_name,\n        c.last_name,\n        c.full_name,\n        c.email,\n        c.phone,\n        \n        -- Location\n        c.city,\n        c.state,\n        c.country,\n        c.postal_code,\n        \n        -- Segmentation\n        c.customer_segment,\n        \n        -- Lifecycle\n        c.registration_date,\n        c.customer_tenure_days,\n        \n        -- Order metrics (from intermediate model)\n        coalesce(co.total_orders, 0) as lifetime_orders,\n        coalesce(co.total_revenue, 0) as lifetime_revenue,\n        coalesce(co.avg_order_value, 0) as avg_order_value,\n        co.first_order_date,\n        co.last_order_date,\n        coalesce(co.days_since_last_order, 9999) as days_since_last_order,\n        \n        -- Customer value tier\n        case\n            when coalesce(co.total_revenue, 0) >= 1000 then 'High Value'\n            when coalesce(co.total_revenue, 0) >= 500 then 'Medium Value'\n            when coalesce(co.total_revenue, 0) > 0 then 'Low Value'\n            else 'No Purchases'\n        end as customer_value_tier,\n        \n        -- Activity status\n        case\n            when co.days_since_last_order <= 30 then 'Active'\n            when co.days_since_last_order <= 90 then 'At Risk'\n            when co.days_since_last_order <= 365 then 'Dormant'\n            else 'Churned'\n        end as activity_status,\n        \n        -- SCD fields\n        true as is_current,\n        current_date as effective_date,\n        null::date as expiration_date,\n        \n        -- Metadata\n        current_timestamp as _created_at,\n        current_timestamp as _updated_at\n        \n    from customers c\n    left join customer_orders co on c.customer_id = co.customer_id\n)\n\nselect * from final", "relation_name": "\"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.976169Z", "completed_at": "2025-12-31T03:56:55.989031Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.989935Z", "completed_at": "2025-12-31T03:56:55.989945Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021551847457885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_products_current_price.36f1e1d8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect current_price\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_products\"\nwhere current_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.980506Z", "completed_at": "2025-12-31T03:56:55.991076Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.992542Z", "completed_at": "2025-12-31T03:56:55.992550Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017275333404541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_products_product_key.a98dfddb9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_key\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_products\"\nwhere product_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.983267Z", "completed_at": "2025-12-31T03:56:55.993136Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:55.994777Z", "completed_at": "2025-12-31T03:56:55.994784Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019106626510620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_dim_products_product_key.5837b56652", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_key as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_products\"\nwhere product_key is not null\ngroup by product_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.995372Z", "completed_at": "2025-12-31T03:56:56.006603Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.010364Z", "completed_at": "2025-12-31T03:56:56.010373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018906354904174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:55.999655Z", "completed_at": "2025-12-31T03:56:56.013708Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.015110Z", "completed_at": "2025-12-31T03:56:56.015118Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02134561538696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.fact_orders", "compiled": true, "compiled_code": "-- fact_orders.sql\n-- Mart model: Order fact table\n\n\n\nwith orders as (\n    select * from \"ecommerce_warehouse\".\"public_staging\".\"stg_orders\"\n),\n\ncustomers as (\n    select customer_key, customer_id \n    from \"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"\n),\n\nfinal as (\n    select\n        -- Surrogate key\n        md5(cast(coalesce(cast(o.order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,\n        \n        -- Natural key\n        o.order_id,\n        \n        -- Foreign keys\n        c.customer_key,\n        o.date_key,\n        \n        -- Order attributes\n        o.order_date,\n        o.order_status,\n        o.payment_method,\n        o.order_value_tier,\n        \n        -- Measures\n        o.subtotal,\n        o.tax_amount,\n        o.shipping_amount,\n        o.total_amount,\n        \n        -- Flags\n        o.is_completed,\n        o.is_fulfilled,\n        \n        -- Metadata\n        o.created_at as order_created_at,\n        current_timestamp as _loaded_at\n        \n    from orders o\n    left join customers c on o.customer_id = c.customer_id\n)\n\nselect * from final", "relation_name": "\"ecommerce_warehouse\".\"public_marts\".\"fact_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.006988Z", "completed_at": "2025-12-31T03:56:56.014725Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.016086Z", "completed_at": "2025-12-31T03:56:56.016092Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017508745193481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_customer_key.4bebfb3411", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_key\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"\nwhere customer_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.011105Z", "completed_at": "2025-12-31T03:56:56.016913Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.019599Z", "completed_at": "2025-12-31T03:56:56.019616Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013705968856811523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_dim_customers_lifetime_revenue.e461788105", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect lifetime_revenue\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"\nwhere lifetime_revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.020315Z", "completed_at": "2025-12-31T03:56:56.030506Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.031500Z", "completed_at": "2025-12-31T03:56:56.031508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015924453735351562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.024954Z", "completed_at": "2025-12-31T03:56:56.034591Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.036865Z", "completed_at": "2025-12-31T03:56:56.036875Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0180511474609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_dim_customers_customer_key.ad8156656e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_key as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"\nwhere customer_key is not null\ngroup by customer_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.028001Z", "completed_at": "2025-12-31T03:56:56.035678Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.037521Z", "completed_at": "2025-12-31T03:56:56.037528Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014248847961425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_analytics.mart_sales_summary", "compiled": true, "compiled_code": "-- mart_sales_summary.sql\n-- Mart model: Daily sales aggregation\n\n\n\nwith orders as (\n    select * from \"ecommerce_warehouse\".\"public_marts\".\"fact_orders\"\n),\n\ndaily_sales as (\n    select\n        date_key,\n        order_date::date as order_date,\n        \n        -- Order counts\n        count(*) as total_orders,\n        count(case when is_completed then 1 end) as completed_orders,\n        \n        -- Revenue metrics\n        sum(total_amount) as gross_revenue,\n        sum(subtotal) as net_revenue,\n        sum(tax_amount) as total_tax,\n        sum(shipping_amount) as total_shipping,\n        \n        -- Averages\n        avg(total_amount) as avg_order_value,\n        \n        -- Customer metrics\n        count(distinct customer_key) as unique_customers,\n        \n        -- Order value distribution\n        count(case when order_value_tier = 'Very Low' then 1 end) as orders_very_low,\n        count(case when order_value_tier = 'Low' then 1 end) as orders_low,\n        count(case when order_value_tier = 'Medium' then 1 end) as orders_medium,\n        count(case when order_value_tier = 'High' then 1 end) as orders_high,\n        count(case when order_value_tier = 'Very High' then 1 end) as orders_very_high\n        \n    from orders\n    group by date_key, order_date::date\n)\n\nselect \n    *,\n    -- Completion rate\n    round(100.0 * completed_orders / nullif(total_orders, 0), 2) as completion_rate,\n    \n    -- Metadata\n    current_timestamp as _loaded_at\n    \nfrom daily_sales\norder by order_date", "relation_name": "\"ecommerce_warehouse\".\"public_marts\".\"mart_sales_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.032022Z", "completed_at": "2025-12-31T03:56:56.038437Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.042840Z", "completed_at": "2025-12-31T03:56:56.042848Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015410661697387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.assert_positive_revenue", "compiled": true, "compiled_code": "-- assert_positive_revenue.sql\n-- Custom data test: Ensure no negative revenue\n\nselect\n    order_id,\n    total_amount\nfrom \"ecommerce_warehouse\".\"public_marts\".\"fact_orders\"\nwhere total_amount < 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.039617Z", "completed_at": "2025-12-31T03:56:56.056003Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.057118Z", "completed_at": "2025-12-31T03:56:56.057127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0208587646484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_fact_orders_order_key.e893eb60e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_key\nfrom \"ecommerce_warehouse\".\"public_marts\".\"fact_orders\"\nwhere order_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.045589Z", "completed_at": "2025-12-31T03:56:56.060868Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.061766Z", "completed_at": "2025-12-31T03:56:56.061775Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01847052574157715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_fact_orders_total_amount.b22b19dd41", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom \"ecommerce_warehouse\".\"public_marts\".\"fact_orders\"\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.048752Z", "completed_at": "2025-12-31T03:56:56.062333Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.063395Z", "completed_at": "2025-12-31T03:56:56.063402Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019711017608642578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_key as from_field\n    from \"ecommerce_warehouse\".\"public_marts\".\"fact_orders\"\n    where customer_key is not null\n),\n\nparent as (\n    select customer_key as to_field\n    from \"ecommerce_warehouse\".\"public_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.057692Z", "completed_at": "2025-12-31T03:56:56.063952Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.068019Z", "completed_at": "2025-12-31T03:56:56.068025Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02281928062438965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_fact_orders_order_key.1d8f1532d5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_key as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public_marts\".\"fact_orders\"\nwhere order_key is not null\ngroup by order_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.064258Z", "completed_at": "2025-12-31T03:56:56.074112Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.074579Z", "completed_at": "2025-12-31T03:56:56.074586Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013320446014404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.not_null_mart_sales_summary_date_key.4d015d5b90", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom \"ecommerce_warehouse\".\"public_marts\".\"mart_sales_summary\"\nwhere date_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-31T03:56:56.070290Z", "completed_at": "2025-12-31T03:56:56.075378Z"}, {"name": "execute", "started_at": "2025-12-31T03:56:56.075680Z", "completed_at": "2025-12-31T03:56:56.075684Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008312225341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_analytics.unique_mart_sales_summary_date_key.8601689d7c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_key as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_warehouse\".\"public_marts\".\"mart_sales_summary\"\nwhere date_key is not null\ngroup by date_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.43187499046325684, "args": {"static": false, "print": true, "log_path": "D:\\project\\DataPipelinePlatform\\dbt_project\\logs", "state_modified_compare_vars": false, "use_fast_test_edges": false, "require_nested_cumulative_type_params": false, "write_json": true, "cache_selected_only": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "static_parser": true, "vars": {}, "require_resource_names_without_spaces": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_all_warnings_handled_by_warn_error": false, "require_unique_project_resource_names": false, "partial_parse_file_diff": true, "favor_state": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "log_format": "default", "skip_nodes_if_on_run_start_fails": false, "partial_parse": true, "which": "generate", "send_anonymous_usage_stats": true, "indirect_selection": "eager", "defer": false, "populate_cache": true, "strict_mode": false, "compile": true, "invocation_command": "dbt docs generate", "empty_catalog": false, "printer_width": 80, "state_modified_compare_more_unrendered_values": false, "project_dir": "D:\\project\\DataPipelinePlatform\\dbt_project", "show_resource_report": false, "profiles_dir": "D:\\project\\DataPipelinePlatform\\dbt_project", "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "log_level_file": "debug", "log_format_file": "debug", "require_ref_searches_node_package_before_root": false, "upload_to_artifacts_ingest_api": false, "log_level": "info", "introspect": true, "use_colors": true, "select": [], "require_yaml_configuration_for_mf_time_spines": false, "exclude": [], "require_generic_test_arguments_property": true, "version_check": true, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "quiet": false}}